import"https://cdn.jsdelivr.net/npm/@theatre/browser-bundles@0.7.2/dist/core-and-studio.js";import prepareProject from"./project.js";const{core:core,studio:studio}=Theatre,projectId=apex.item("P2_PROJECT_ID").getValue();apex.debug.info("projectId: ",projectId),studio.initialize();const r=prepareProject(core,projectId,null),channel=new BroadcastChannel("control-theatre");channel.addEventListener("message",e=>{if(apex.debug.info("event: ",e),"export"===e.data.type){const e=studio.createContentOfSaveFile(projectId);apex.debug.info("projectState: ",e),apex.item("P2_PROJECT_STATE").setValue(JSON.stringify(e)),apex.server.process("SAVE_PROJECT_STATE",{pageItems:"#P2_PROJECT_ID,#P2_PROJECT_STATE"},{success:e=>{apex.debug.info(e),channel.postMessage({type:"status",message:e.message})}})}});